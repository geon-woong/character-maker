

# 캐릭터 제작 올인원 공작소 - Todo List

## 🎯 우선순위 1단계 (Core Features)

### Phase 1: 캐릭터 정면 제작 완성
- [ ] **기본 파츠 시스템 구축**
  - [x] 얼굴, 눈, 코, 입, 귀 파츠 라이브러리 구성
  - [x] 몸통(팔, 다리 포함) 파츠 라이브러리 구성
  - [ ] 꼬리 파츠 라이브러리 구성

- [ ] **무늬 시스템 구축**
  - [ ] 볼터치, 귀 무늬, 배 무늬 옵션
  - [ ] 눈썹, 동물 무늬 옵션
  - [ ] 무늬 3개 이하 제한 UI 안내

- [x] **편집 기능 구현**
  - [x] 각 파츠별 위치 조정 기능
  - [x] 각 파츠별 회전 기능
  - [x] 각 파츠별 색상 변경(채색) 기능
  - [x] 레이어 순서 조정 기능 (접힌 귀 등 대응)

- [ ] **찌바 가이드 시스템**
  - [ ] 팝업 형식 말풍선 UI 구현
  - [ ] 꿀팁 메시지 데이터베이스 구축
    - "눈과 코가 가까우면 어려 보이고, 멀면 성숙해 보여!"
    - "과유불급! 무늬는 3개 이하 추천!"
  - [ ] 각 편집 단계별 적절한 타이밍에 팁 표시

---

### Phase 2: 캐릭터 턴어라운드 제작
- [x] **기본 뷰 생성 시스템**
  - [x] 정면 데이터를 기반으로 한 자동 변환 로직 구현
  - [x] 4방향 뷰 캔버스 구성 (앞, 옆, 뒤, 측면)

- [ ] **옆면 뷰 생성 로직**
  - [ ] 눈 가로 크기 60% 자동 축소
  - [ ] 코/입 절반 잘라내기 + 얼굴 옆선 배치
  - [ ] 볼터치 등 무늬 가로 60% 축소
  - [ ] 꼬리 위치 조정

- [ ] **뒷면 뷰 생성 로직**
  - [x] 눈/코/입 자동 제거
  - [ ] 뒷면용 파츠(꼬리 등) 배치

- [ ] **측면 뷰 생성 로직**
  - [ ] 전체 위치 왼쪽 이동
  - [ ] 왼쪽 눈 위치 코 쪽으로 조정
  - [ ] 넘치는 무늬 처리 방법 구현
    - 옵션1: 흰색 배경 마스킹
    - 옵션2: 크기 제한 유효성 검사
  - [ ] 최적 방법 테스트 및 확정

- [ ] **턴어라운드 편집 기능**
  - [ ] 각 뷰별 개별 크기 조정
  - [ ] 각 뷰별 위치 미세 조정
  - [ ] 각 뷰별 회전 조정

---

### Phase 3: 캐릭터 동작 제작

> **핵심 설계**: 동작(Action) = 포즈(Pose) + 표정(Expression) 프리셋 조합
> - Pose: body, arms, legs 에셋 결정 (자세)
> - Expression: eyes, mouth 에셋 결정 (표정)
> - face, nose, ears 등은 포즈/표정에 무관하게 Phase 1 데이터 재사용

#### 🔧 개발자 작업

- [x] **타입 시스템 확장** (`src/types/character.ts`)
  - [x] `PoseId` 확장: `'standing' | 'walking' | 'running' | 'sitting' | 'lying' | 'jumping'`
  - [x] `ExpressionId` 확장: `'neutral' | 'happy' | 'sad' | 'angry' | 'surprised'`
  - [x] `Pose`, `Expression` 인터페이스에 `thumbnail`, `category` 추가
  - [x] `Action` 프리셋 타입 추가 (id, name, poseId, expressionId, thumbnail, category)
  - [x] `PartDefinition`에 `variesByPose` 필드 추가
  - [x] `MakerStep`에 `'action'` 단계 추가

- [x] **포즈/표정/동작 데이터** (신규 `src/data/poses-expressions.ts`)
  - [x] `POSES` 데이터 정의 (6개 포즈, 카테고리: basic/emotion/special)
  - [x] `EXPRESSIONS` 데이터 정의 (5개 표정)
  - [x] `ACTIONS` 프리셋 조합 데이터 정의
  - [x] `POSE_MAP`, `EXPRESSION_MAP`, `ACTION_MAP` 조회 맵

- [x] **파츠 데이터 확장** (`src/data/parts.ts`)
  - [x] 모든 파츠에 `variesByPose` 플래그 추가
  - [x] body/body2/arms/legs: `variesByPose: true` (포즈별 에셋)
  - [x] eyes/mouth: `variesByPose: false`, `variesByExpression: true` (표정별 에셋)
  - [x] face/face2/nose/ears/ear2: 둘 다 false (포즈/표정 무관)
  - [x] variant key 패턴 변경: `"any/default"`, `"any/{expressionId}"`, `"{poseId}/default"`

- [x] **레이어 해석 로직** (`src/lib/composer/layer-order.ts`)
  - [x] `buildVariantKey()` 함수: variesByPose/variesByExpression 기반 키 생성
  - [x] `resolveVariantKey()` 함수: fallback 체인 (정확한 키 → standing → neutral → 첫 번째)
  - [x] `resolveLayers()` 및 `resolveLayersForDirection()` 업데이트

- [x] **상태 관리 확장** (`src/stores/character-store.ts`)
  - [x] `activePoseId`, `activeExpressionId`, `activeActionId` 상태 추가
  - [x] `setPose()`, `setExpression()`, `setAction()` 액션 추가
  - [x] 세션 스토리지 마이그레이션 v6 → v7
  - [x] `resetCharacter()`, `randomizeAll()` 업데이트

- [x] **기존 컴포넌트 하드코딩 제거**
  - [x] `CharacterPreview.tsx`: 스토어에서 activePoseId/activeExpressionId 사용
  - [x] `DirectionPreview.tsx`: 동일
  - [x] `ExportButton.tsx`: 동일
  - [x] `EditModeModal.tsx`: 동일

- [x] **동작 선택 UI 구현**
  - [x] `ActionPresetGrid.tsx`: 동작 프리셋 카드 그리드 (기본/감정/특수)
  - [x] `PoseSelector.tsx`: 포즈 개별 선택 UI
  - [x] `ExpressionSelector.tsx`: 표정 개별 선택 UI
  - [x] `maker/page.tsx`: `step === 'action'` 단계 추가 (parts → action → direction)

#### 🎨 디자이너 작업

- [ ] **포즈별 몸통 에셋 제작** (SVG, 1080×1080 캔버스)
  - [ ] `body/` 카테고리: 6포즈 × 2파츠 = **12개 SVG**
    - standing(기존), walking, running, sitting, lying, jumping
  - [ ] `body2/` 카테고리: 6포즈 × 1파츠 = **6개 SVG**
  - [ ] `arms/` 카테고리: 6포즈 × 2파츠 = **12개 SVG**
  - [ ] `legs/` 카테고리: 6포즈 × 2파츠 = **12개 SVG**
  - 경로: `public/assets/parts/{category}/{poseId}/{number}.svg`

- [ ] **표정별 눈/입 에셋 제작**
  - [ ] `eyes/` 카테고리: 5표정 × 2파츠 = **10개 SVG**
    - neutral(기존), happy, sad, angry, surprised
  - [ ] `mouth/` 카테고리: 5표정 × 2파츠 = **10개 SVG**
  - 경로: `public/assets/parts/{category}/{number}-{expressionId}.svg`

- [ ] **썸네일 에셋 제작**
  - [ ] 포즈 썸네일: **6개** (`public/assets/poses/{poseId}.svg`)
  - [ ] 표정 썸네일: **5개** (`public/assets/expressions/{expressionId}.svg`)
  - [ ] 동작 프리셋 썸네일 (선택사항)

- [ ] **에셋 총 수량: ~73개 신규 SVG**
  - 포즈별 body/arms/legs: ~42개
  - 표정별 eyes/mouth: ~20개
  - 썸네일: ~11개

> **참고**: 에셋이 아직 없는 조합은 standing/neutral 에셋으로 자동 fallback됩니다.
> 디자이너 작업과 개발을 병행할 수 있습니다.

---

## 🔄 우선순위 2단계 (Extended Features)

### Phase 4: 이모티콘 제작
- [ ] **컷 이미지 편집 시스템**
  - [ ] 동작 선택 기능
  - [ ] 텍스트 추가 툴
  - [ ] 효과 추가 툴
  - [ ] 소품 추가 툴
  - [ ] 배경 추가 툴

- [ ] **정적 이모티콘 생성**
  - [ ] 최종 이미지 합성 엔진
  - [ ] 이모티콘 규격 내보내기 (카톡, 라인 등)

- [ ] **움직이는 이모티콘 제작**
  - [ ] 프레임 애니메이션 시스템
  - [ ] 타임라인 편집기
  - [ ] GIF/APNG 내보내기

---

### Phase 5: 인스타툰 제작
- [ ] **프레임 시스템**
  - [ ] 다양한 레이아웃 템플릿 (1컷, 4컷, 6컷 등)
  - [ ] 프레임 크기/간격 조정

- [ ] **말풍선 시스템**
  - [ ] 다양한 말풍선 스타일 라이브러리
  - [ ] 말풍선 위치/크기 조정
  - [ ] 텍스트 입력 및 스타일링

- [ ] **컷 편집 기능**
  - [ ] 각 컷에 캐릭터 동작 배치
  - [ ] 배경/효과 추가
  - [ ] 인스타그램 규격 내보내기

---

### Phase 6: 굿즈 제작
- [ ] **굿즈 도안 편집기**
  - [ ] 동작 선택 및 배치
  - [ ] 소품 라이브러리
  - [ ] 효과 라이브러리

- [ ] **굿즈 타입별 템플릿**
  - [ ] 스티커 도안 템플릿
  - [ ] 메모지 도안 템플릿
  - [ ] 기타 굿즈 템플릿

- [ ] **인쇄용 내보내기**
  - [ ] 고해상도 이미지 생성
  - [ ] 재단선 포함 옵션
  - [ ] PDF/AI 파일 내보내기

---

### Phase 7: 포트폴리오 제작
- [ ] **포트폴리오 구성 요소 정의**
- [ ] **자동 포트폴리오 생성 기능**
- [ ] **PDF 내보내기**

---

## 📋 개발 순서 요약
1. **1단계**: 캐릭터 정면 제작 완성 → 턴어라운드 → 동작 제작
2. **2단계**: 이모티콘 → 인스타툰 → 굿즈 → 포트폴리오
